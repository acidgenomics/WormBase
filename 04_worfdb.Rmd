---
title: "WORFDB annotations"
date: "`r BiocStyle::doc_date()`"
---

```{r setup, message=FALSE}
source("setup.R")
```

```{r header, child="header.Rmd"}
```



```{r worfdb1}
loadData(worfdbHTML)
worfdb1 <- worfdbData(worfdbHTML)
saveData(worfdb1, dir = dataDir, compress = compress)
```

```{r worfdb2}
# [fix] R153.1f
loadData(worfdbHTMLRemap)
worfdb2 <- worfdbData(worfdbHTMLRemap)
saveData(worfdb2, dir = dataDir, compress = compress)
```

```{r worfdb}
loadData(geneIDs)
# [fix] all NA row?
# [fix] 30037G9, 30040G2
worfdb <- bind_rows(worfdb1, worfdb2) %>%
    filter(is.na(remap)) %>%
    select(-c(query, remap)) %>%
    distinct %>%
    arrange(clone) %>%
    left_join(geneIDs[, c("gene", "sequence")], by = "sequence")
saveData(worfdb, dir = dataDir, compress = compress)
```

```{r unmatched}
worfdb %>%
    filter(is.na(gene)) %>%
    glimpse()
```

Check for duplicate sequences:

```{r dupes}
dupes <- worfdb %>%
    group_by(clone) %>%
    filter(n() > 1) %>%
    select(clone, everything())
glimpse(dupes)
```



```{r footer, child="footer.Rmd"}
```
